<script>
  function formatJSON() {
    const input = document.getElementById('input').value.trim();
    const errorDiv = document.getElementById('error');
    errorDiv.textContent = '';

    if (!input) {
      errorDiv.textContent = 'Cole algum JSON para formatar.';
      return;
    }

    try {
      // Se já for um objeto JSON válido
      if (input.startsWith('{') && input.endsWith('}')) {
        const parsed = JSON.parse(input);
        document.getElementById('output').value =
          JSON.stringify(parsed, null, 2);
        return;
      }

      // Caso sejam múltiplos objetos separados por vírgula
      const wrapped = `[${input}]`;
      const parsedArray = JSON.parse(wrapped);

      // Mescla tudo em um único objeto
      const merged = Object.assign({}, ...parsedArray);

      document.getElementById('output').value =
        JSON.stringify(merged, null, 2);

    } catch (err) {
      errorDiv.textContent =
        'JSON inválido. Verifique aspas, vírgulas ou chaves.\n\n' +
        err.message;
    }
  }

  function copyJSON() {
    const output = document.getElementById('output');
    if (!output.value) return;
    output.select();
    document.execCommand('copy');
  }
</script>
